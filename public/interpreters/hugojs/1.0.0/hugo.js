!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getParameter=i,t.get=function(e){return r[e]},t.init=function(e){var t;for(t in e=e||{})e.hasOwnProperty(t)&&void 0!==e[t]&&(r[t]=e[t]);r.lock_story||(r.story=i("story","string",r.story));if(!r.lock_options){for(t in r)"story"!==t&&r.hasOwnProperty(t)&&(r[t]=i(t,o(r[t]),r[t]));"false"!==r.exit_url&&"0"!==r.exit_url||(r.exit_url=!1)}},t.set=function(e,t){r[e]=t};var r={autosave:!0,exit_url:"",extra_opcodes:!0,proxy_url:"proxy.php",use_proxy:"auto",windowing:!0};function i(e,t,n){var o,r=new RegExp("[?&]"+e+"=(.*?)(#|&|$)","i").exec(window.location.href);if(null===r||r.length<2)return n;switch(o=decodeURIComponent(r[1].split("+").join(" ")),t){case"boolean":return"true"===o.toLowerCase()||"on"===o||"1"===o||"false"!==o.toLowerCase()&&"off"!==o&&"0"!==o&&n;case"number":return parseFloat(o)+""===o?parseFloat(o):NaN;default:return 0===o.length?n:o}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resizeInput=b,t.get=function(){return g},t.hide=w,t.waitLine=function(){return new Promise(function(e){O=function(t){return e(t)}})},t.init=function(e){if(d=!!e.enginePrompt,g.addEventListener("submit",function(t){t.preventDefault(),e.unicode||(f.value=f.value.replace(/[^\u0000-\u007E]/g,function(e){return C[e]||e})),f.value!==s[0]&&/\S/.test(f.value)&&s.unshift(f.value),l=-1,d||t.detail&&t.detail.silent||function(e,t,n){for(var o=a.container.get(n),r=document.createElement("div"),i=document.createElement("span"),s=document.createElement("span"),l=document.getElementsByClassName("lineinput last"),c=l.length-1;c>=0;--c)l[c].classList.remove("last");r.className="lineinput last",i.className="prompt-prefix",s.className="prompt-input",i.innerHTML=e,s.innerHTML=t,r.appendChild(i),r.appendChild(s),o.appendChild(r)}(L.get(),f.value,0),O(f.value+"\n"),f.value="",w()},!1),f.addEventListener("keydown",function(e){var t=e.which||e.keyCode;38===t&&(v(1),e.preventDefault()),40===t&&(v(-1),e.preventDefault())},!1),"ontouchstart"in window){var t=!0;f.addEventListener("focus",function(){t?t=!1:document.body.classList.add("safarifix")}),f.addEventListener("blur",function(){document.body.classList.remove("safarifix")})}window.addEventListener("resize",b,!1),g.parentNode.removeChild(g)},t.isReady=function(){return"getline"===(0,r.getMode)()},t.scrollOrFocus=_,t.setDoScroll=function(e){u=e},t.show=function(){(0,r.setMode)("getline"),(0,o.flush)(),(0,a.get)(0).appendChild(g),p=d?f.offsetLeft-(0,a.get)(0).offsetLeft:h.offsetWidth;b(),_(),u=!0,i.autosave.save(),g.dispatchEvent(m)},t.prefix=t.history=void 0;var o=n(3),r=n(2),i=n(6),a=n(5),s=[],l=-1,c="",u=!1,d=!1,f=document.getElementById("lineinput-field"),p=0,h=document.getElementById("lineinput-prefix"),g=document.getElementById("lineinput"),m=new CustomEvent("lineinputReady");function v(e){var t=l+e;-1===l&&(c=f.value),t<s.length&&t>=0?(f.value=s[t],l=t):-1===t&&(f.value=c,l=t)}function b(){f.style.width=(0,a.get)(0).clientWidth-p-2+"px"}function y(){for(var e=(0,a.get)(0),t=(0,a.get)(1),n=function e(t){var n=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?n.push(t):n=n.concat(e(t));return n}(e),o=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),r=/\S/,i=0;i<n.length;++i)if(r.test(n[i].textContent)){var s=n[i].parentNode.getBoundingClientRect().top-window.innerHeight/3;return t&&(s+=t.getBoundingClientRect().height),void(o<s&&window.scrollTo(0,s))}}function w(){(0,r.setMode)("buffer"),g.parentNode&&g.parentNode.removeChild(g)}var x={add:function(e){return!!e&&(s.push(e),!0)},clear:function(){s=[]},get:function(){return s.slice()},remove:function(e){return 0!==s.length&&("number"!=typeof e?(s.pop(),!0):!(e<0||e>=s.length)&&void s.splice(e,1))},set:function(e){s=e.slice()}};t.history=x;for(var k=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"OE",letters:"Œ"},{base:"oe",letters:"œ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],C={},E=0;E<k.length;E++)for(var S=k[E].letters,T=0;T<S.length;T++)C[S[T]]=k[E].base;var O=function(){};var L={get:function(){return d?"":h.innerHTML},set:function(e){d||(h.innerHTML=e)}};function _(e){var t=document.documentElement,n=(window.pageYOffset||t.scrollTop)-(t.clientTop||0),o=window.getSelection||function(){return document.selection?document.selection.createRange().text:""},r=window.innerHeight;if((0,a.get)(1)&&(r=window.innerHeight-haven.window.get(1).getBoundingClientRect().height),!e||!(32===e.keycode||e.keyCode>127||e.altKey||e.ctrlKey||e.metaKey)){if(!e||e.target&&"INPUT"!==e.target.nodeName&&""===o().toString())if(n+window.innerHeight>document.body.clientHeight-40)g.parentNode&&(window.scrollTo(0,9e9),f.focus(),e&&e.stopPropagation&&document.activeElement!==f&&e.stopPropagation());else if(u?(window.scrollTo(0,n+r-40),g.parentNode&&n+r+window.innerHeight-40>=document.body.clientHeight&&f.focus(),e&&e.preventDefault&&e.preventDefault()):y(),e&&"keydown"===e.type&&8===(e.which||e.keyCode))return!1;!1}}t.prefix=L},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMode=function(){return s},t.init=function(){document.addEventListener("keydown",d.send,!1),document.addEventListener("click",d.send,!1)},t.setMode=function(e){s=e},t.textWasPrinted=f,t.getTextWasPrinted=function(){return f},t.keypress=void 0;var o,r=n(3),i=n(1),a=(o=n(8))&&o.__esModule?o:{default:o};var s=null,l=[],c=!1;var u=function(){},d={init:function(){s||(s="buffer")},isWaiting:function(){return(0,r.flush)(),c&&(0,i.scrollOrFocus)(),l.length>0},send:function(e){var t=e.keyCode,n=document.documentElement,o=(window.pageYOffset||n.scrollTop)-(n.clientTop||0);if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){switch(s){case"buffer":l.push(t);break;case"getline":case null:return void(0,i.scrollOrFocus)(e);case"getkey":break;case"endgame":return void(window.location=hugojs_options.exit_url);default:(0,a.default)("Interpreter error: unknown input mode "+s)}s="buffer",o+window.innerHeight<document.body.clientHeight-40?(0,i.scrollOrFocus)(e):u(t)}},wait:function(){s="getkey",(0,r.flush)(),(0,i.setDoScroll)(),l.length>0&&setTimeout(function(){return d.send({keyCode:l.shift()})},0)},waitPromise:function(){return new Promise(function(e){u=function(t){return e(t)}})}};function f(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];c=e}t.keypress=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.append=function(e,t){r[t]||(r[t]="");if(e.indexOf("\n")>-1||e.indexOf("\r")>-1){var n=Math.max(e.lastIndexOf("\n"),e.lastIndexOf("\r"))+1;r[t]+=i(e.substr(0,n)),a(t),r[t]=i(e.substr(n))}else r[t]+=i(e)},t.flush=a,t.newline=function(e){r[e]?r[e]+="\n":r[e]="\n";a(e)};var o=n(2),r=[""];function i(e){for(var t="",n=0;n<e.length;++n)if(e.charCodeAt(n)>127)t+="&#"+e.charCodeAt(n)+";";else switch(e[n]){case"&":t+="&amp;";break;case"<":t+="&lt;";break;case">":t+="&gt;";break;case"\r":t+="\n";break;default:t+=e[n]}return t}function a(e){if(void 0===e)for(var t in r)a(+t);r[e]&&haven.window.get(e)&&(haven.window.append(r[e],e),r[e]="",0===e&&(0,o.textWasPrinted)(!0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apply=function(e,t){var n=[],o=(0,r.get)().getElementsByTagName("INPUT")[0],u=0===t;i[t]||(i[t]=c(t));s&&(n.push("textcolor-"+i[t].text),n.push("bgcolor-"+i[t].background));e.className=e.className.replace(/\b(text|bg)color-\d+/g,""),e.classList.remove("font-fixed-width"),u&&(o.className=o.className.replace(/\b(text|bg)color-\d+/g,""),o.classList.remove("font-fixed-width"));a[t]||(a[t]={bold:!1,italic:!1,underline:!1,proportional:!0,original:0});for(var d in a[t])l&&"proportional"===d||a[t].hasOwnProperty(d)&&(e.classList.remove("font-"+d),u&&o.classList.remove("font-"+d),a[t][d]&&n.push("font-"+d));l||!a[t].hasOwnProperty("proportional")||a[t].proportional||n.push("font-fixed-width");for(var f=0;f<n.length;++f)e.classList.add(n[f]),u&&o.classList.add(n[f])},t.init=function(e){l=!e.engineFontFamily,s=e.engineColors},t.restore=function(e){a=e},t.set=function(e,t,n){(0,o.flush)(n),a[n][e]=t},t.font=t.color=void 0;var o=n(3),r=(n(0),n(1)),i=[c(0)],a=[{bold:!1,italic:!1,underline:!1,proportional:!0,original:0}],s=!0,l=!1;function c(e){return 1===e?{text:15,background:1}:{text:7,background:0}}var u={get:function(){return i},restore:function(e){i=e},set:function(e,t,n){i[n]||(i[n]=c(n)),i[n][e]!==t&&((0,o.flush)(n),i[n][e]=t)}};t.color=u;var d={get:function(){return a}};t.font=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.append=function(e,t){var n=document.createElement("span");d[t]||(d[t]={col:null,line:null});(0,a.apply)(n,t),n.innerHTML=e,null!==d[t].col&&null!==d[t].line?function(e,t,n,o){var r=s[o],i=function e(t){var n=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?n.push(t):n=n.concat(e(t));return n}(r),a=document.createRange(),l=1,c=1,u=!1,f=0;if(function(){for(var o=0;o<i.length;++o){var r=i[o].textContent;if(l===e)for(var s=0;s<r.length;++s){if(u){if(++f===n.textContent.length||"\n"===r[s])return a.setEnd(i[o],s),!1}else if(c===t){if(a.setStart(i[o],s),u=!0,s===r.length-1)return a.setEnd(i[o],s),!1}else if("\n"===r[s]){var d=document.createTextNode(Array(t-c+1).join(" ")+"\n");return i[o].textContent=r.substr(0,s)+" ",i[o].parentNode.insertBefore(d,i[o].nextSibling),a.setStart(d,t-c-1),a.setEnd(d,t-c-1),!1}c++}else r.indexOf("\n")>-1&&l++}return!0}())return function(e,t,n){for(var o=0;o<e;++o){var r=document.createElement("span");r.className="font-fixed-width",r.innerHTML="\n",s[n].appendChild(r)}if(t>0){var i=document.createElement("span");i.innerHTML=Array(t).join(" "),i.className="font-fixed-width",s[n].appendChild(i)}g.reset(n)}(d[o].line-l,t,o),void r.appendChild(n);n.textContent.indexOf("\n")>-1?(n.textContent=n.textContent.replace("\n",""),d[o].line++,d[o].col=1):d[o].col+=n.textContent.length;a.deleteContents(),a.insertNode(n),n.nextSibling||(d[o].line=null,d[o].col=null)}(d[t].line,d[t].col,n,t):c[t].appendChild(n)},t.clear=function(e){if(void 0===e)(0,o.flush)(0),l.innerHTML="",l.appendChild(s[0]),(0,a.apply)(s[0],0),(0,a.apply)(document.body,0),g.reset();else{if(!s[e])return;(0,o.flush)(e),s[e].innerHTML="",(0,a.apply)(s[e],e),0===e&&(0,a.apply)(document.body,0),g.reset(e)}},t.create=function(e,t,n,o,i){var a,l=h(),d=l.char.height,g=p(0).parentNode;if(u[e]={left:t,top:n,right:o,bottom:i},!(0,r.get)("windowing"))return!1;if(0===e)return void(p(0).style.paddingTop=(n-1)*l.char.height+"px");p(e)&&g.removeChild(p(e));(a=document.createElement("div")).id="window"+e,a.className="havenwindow font-fixed-width",a.style.height=d*(i-n+1)+"px",a.style.top=(n-1)*d+"px",a.style.marginLeft=t-1+"px",a.style.width=(o-t+2)*l.char.width+"px",s[e]=a,c[e]=a,f.append(a,g)},t.get=p,t.getUIState=function(){var e=[],t=(0,i.get)(),n=t.parentNode;n&&n.removeChild(t);var o=s[0].lastChild;s[0].removeChild(o);for(var r=0;r<s.length;++r)e[r]=s[r].innerHTML;s[0].appendChild(o),n&&n.appendChild(t);var l=e[0].lastIndexOf("\n");return e[0]=e[0].substring(0,l)+e[0].substring(l+1),{cmdHistory:i.history.get(),currentColors:a.color.get(),font:a.font.get(),position:d,title:document.title,windowDimensions:u,windowContents:e}},t.measureDimensions=h,t.setTitle=function(e){document.title=e},t.position=t.container=void 0;var o=n(3),r=n(0),i=n(1),a=n(4),s=[document.getElementById("window0")],l=document.getElementById("output"),c=[s[0]],u=[],d=[];var f={append:function(e,t){"number"==typeof t?s[t].appendChild(e):t.appendChild(e)},get:function(e){return c[e]},set:function(e,t){c[t]=e}};function p(e){return s[e]}function h(){var e,t=p(0).parentNode,n={window:{width:parseInt(window.getComputedStyle(t).width,10),height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},line:{},char:{}},o=document.createElement("span"),r=n.window;return o.innerHTML="00000<br>00000<br>00000",o.className="font-fixed-width",o.style.display="inline-block",t.appendChild(o),n.char.width=o.offsetWidth/5,n.line.width=Math.floor((r.width-1)/n.char.width),o.style.display="block",e=o.clientHeight,o.innerHTML+="<br>00000<br>00000",n.char.height=(o.clientHeight-e)/2+3,n.line.height=Math.floor(r.height/n.char.height),o.parentNode.removeChild(o),n}t.container=f;var g={reset:function(e){void 0===e?d=[{col:null,line:null}]:g.set(null,null,e)},restore:function(e){d=e},set:function(e,t,n){d[n]||(d[n]={}),d[n].col=e,d[n].line=t}};t.position=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUI=function(){var e,t=function(){try{var e=FS.readFile(s+"_uidata",{encoding:"utf8"});return JSON.parse(e)}catch(e){return null}}();if(!t)return;e=(0,o.get)("windowing")?t.windowContents.length:1;(0,i.clear)();for(var n=0;n<e;++n)(0,i.create)(n,t.windowDimensions[n].left,t.windowDimensions[n].top,t.windowDimensions[n].right,t.windowDimensions[n].bottom);a.color.restore(t.currentColors),(0,a.restore)(t.font),i.position.restore(t.position),t.title&&(document.title=t.title);for(var l=0;l<t.windowContents.length;++l)(0,i.get)(l).innerHTML=t.windowContents[l],(0,a.apply)(haven.window.get(l),l);(0,a.apply)(document.body,0),Module.ccall("hugojs_set_font","null",["int"],[t.font[0].original]),Module.ccall("hugojs_set_colors","null",["int","int"],[t.currentColors[0].text,t.currentColors[0].background]),r.history.set(t.cmdHistory||[]),window.scrollTo(0,9e9),(0,r.setDoScroll)()},t.autosave=void 0;var o=n(0),r=n(1),i=n(5),a=n(4),s="";var l={remove:function(){try{FS.unlink(s)}catch(e){}try{FS.unlink(s+"_uidata")}catch(e){}},restore:function(){try{FS.stat(s),Module.ccall("hugojs_set_autosave_filename","null",["string"],[s])}catch(e){}},save:function(){(0,o.get)("autosave")&&(Module.ccall("haven_save_autosave","int",["string"],[s])&&FS.writeFile(s+"_uidata",JSON.stringify(haven.window.getUIState()),{encoding:"utf8"}))},setName:function(e){s=e}};t.autosave=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addCallback=function(e){0===r.length&&setTimeout(e,0);i.push(e)},t.expect=function(e){if(0===r.length)return void console.warn('An expected asset "'+e+'" was added but all previous assets have already finished loading');r.push(e)},t.finalCallback=function(e){o=e},t.finished=function(e){var t=r.indexOf(e);if(-1===t)return!1;r.splice(t,1),0===r.length&&function(){var e=0;if(0===i.length)return;i[0](function t(){++e<i.length?i[e](t):o&&o()})}();return!0};var o,r=["engine","storyfile"],i=[]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElement("div"),n=document.getElementById("spinner"),o=document.getElementById("loader");t.id="fatal-error",t.innerHTML=e,document.body.appendChild(t),n&&n.parentNode.removeChild(n);o&&(o.className="stopped");throw new Error(e)}},function(e,t,n){var o,r,i={},a=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=o.apply(this,arguments)),r}),s=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),l=null,c=0,u=[],d=n(15);function f(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=i[o.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](o.parts[a]);for(;a<o.parts.length;a++)r.parts.push(b(o.parts[a],t))}else{var s=[];for(a=0;a<o.parts.length;a++)s.push(b(o.parts[a],t));i[o.id]={id:o.id,refs:1,parts:s}}}}function p(e,t){for(var n=[],o={},r=0;r<e.length;r++){var i=e[r],a=t.base?i[0]+t.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};o[a]?o[a].parts.push(s):n.push(o[a]={id:a,parts:[s]})}return n}function h(e,t){var n=s(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=u[u.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),u.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=s(e.insertInto+" "+e.insertAt.before);n.insertBefore(t,r)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function m(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),v(t,e.attrs),h(e,t),t}function v(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function b(e,t){var n,o,r,i;if(t.transform&&e.css){if(!(i=t.transform(e.css)))return function(){};e.css=i}if(t.singleton){var a=c++;n=l||(l=m(t)),o=x.bind(null,n,a,!1),r=x.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),h(e,t),t}(t),o=function(e,t,n){var o=n.css,r=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||i)&&(o=d(o));r&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([o],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,t),r=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(t),o=function(e,t){var n=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){g(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=p(e,t);return f(n,t),function(e){for(var o=[],r=0;r<n.length;r++){var a=n[r];(s=i[a.id]).refs--,o.push(s)}e&&f(p(e,t),t);for(r=0;r<o.length;r++){var s;if(0===(s=o[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete i[s.id]}}}};var y,w=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function x(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=w(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(a=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),i=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[n].concat(i).concat([r]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(e){var t,n,o=(0,s.get)("story"),a=(0,s.get)("uploadedFile"),l=(0,s.get)("use_proxy"),c=function(e){g=!0,u=new Uint8Array(e),d=function(e){for(var t=e.length,n=0,o=0;o<t;o++)n=n+((n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)>>>0)^255&e[o];return n>>>0}(u).toString(16),(0,r.finished)("storyfile")};if(p=e,a){var f=new FileReader;return f.onload=function(e){var t=document.getElementById("uploadContainer");t&&t.parentNode.removeChild(t),c(e.target.result)},(0,r.addCallback)(m),void f.readAsArrayBuffer(a)}o||(0,i.default)("No story file specified");var h=new XMLHttpRequest;switch(""+l){case"always":case"true":case"1":n=!0;break;case"never":case"false":case"0":n=!1;break;default:n=/^https?:\/\//.test(o)&&0!==o.indexOf(window.location.protocol+"//"+window.location.host),"auto"!==l&&console.warn('Unknown use_proxy option "'+l+'", using "auto"')}t=n?(0,s.get)("proxy_url").split("%s").join(encodeURIComponent(o)):o;(0,r.addCallback)(m),h.onreadystatechange=function(){if(h.readyState==XMLHttpRequest.DONE)switch(h.status){case 200:c(h.response);break;case 404:(0,i.default)("Game file not found");break;case 415:n?(0,i.default)(String.fromCharCode.apply(null,new Uint8Array(h.response))):(0,i.default)("Unsupported Media Type error encountered when loading game file");break;case 0:(0,i.default)("Unspecified error loading game file (possibly cross-origin restriction)");break;default:(0,i.default)("Error loading game file. Server returned status code "+h.status+" ("+h.statusText+")")}},h.open("GET",t,!0),h.responseType="arraybuffer",h.send()},t.prompt=function(e){var t=window.prompt("Enter filename "+e),n=(0,l.get)().getElementsByTagName("INPUT")[0];t&&/\S/.test(t)?n.value=f+"/"+t.split("/").join("-"):n.value="";setTimeout(function(){(0,l.get)().dispatchEvent(new Event("submit")),setTimeout(function(){FS.syncfs(!1,function(){})},1e3)},1)},t.readUIState=function(){try{var e=FS.readFile(autosaveFilename+"_haven_uidata",{encoding:"utf8"});return JSON.parse(e)}catch(e){return null}},t.syncfs=function(){FS.syncfs(!1,function(){})};var o,r=n(7),i=(o=n(8))&&o.__esModule?o:{default:o},a=n(2),s=n(0),l=n(1),c=n(6);n(21);var u,d,f,p,h=!1,g=!1;function m(e){document.getElementById("loader").style.display="block",h&&g||(document.getElementById("loader-message").innerHTML=h?"Loading game file":"Loading interpreter"),document.getElementById("loader-message").innerHTML="Starting game",FS.writeFile(p,u,{encoding:"binary"}),f="/gamedata_"+d,FS.analyzePath(f).exists||FS.mkdir(f),FS.mount(IDBFS,{root:"."},f),FS.analyzePath("gamedata").exists||FS.mkdir("gamedata"),FS.mount(IDBFS,{root:"."},"gamedata"),FS.chdir("gamedata"),FS.syncfs(!0,function(){(0,s.get)("autosave")&&(c.autosave.setName("/gamedata_"+d+"/autosave"),c.autosave.restore()),a.keypress.init(),e()})}window.onbeforeunload=function(){FS.syncfs(!1,function(){})},document.getElementById("loader-message").innerHTML="Loading interpreter and game file"},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,"body, html {\n    margin: 0;\n    padding: 0;\n}\n\nbody {\n    overflow-y: scroll;\n}\n\nbody,\ninput,\n#loader {\n    color: #aaa;\n    background-color: #000;\n    font-family: monospace;\n}\n\nbody,\ninput {\n    font-size: 17px;\n}\n\n#lineinput {\n    display: inline-block;\n}\n\n#output {\n    max-width: 751px;\n    padding: 0 15px 10px 15px;\n    margin: 0 auto;\n}\n\n#output span {\n    white-space: pre-wrap;\n}\n\n#lineinput {\n    display: inline-block;\n    width: 500px;\n}\n\n#lineinput-field {\n    border: 0;\n    display: inline;\n    outline: 0;\n    padding: 0;\n    width: 100%;\n}\n\n.havenwindow {\n    position: fixed;\n    overflow: hidden;\n}\n\n.safarifix .havenwindow {\n    position: absolute;\n}\n\n#loader {\n    position: fixed;\n    top: 0;\n    right: 0;\n    left: 0;\n    bottom: 0;\n}\n\n#loader-message {\n    margin-top: 100px;\n    text-align: center;\n}\n\n#loader.stopped #loader-message {\n    text-decoration: line-through;\n}\n\n#spinner {\n    position: fixed;\n    padding-top: 90px;\n    font-family: serif;\n    color: #555;\n    background-color: #000;\n    opacity: 0.7;\n    top: 0;\n    left: 5%;\n    width: 100%;\n    height: 100%;\n    line-height: 100%;\n    font-size: 50px;\n    animation: slide 5s ease-in-out forwards;\n    animation-iteration-count: infinite;\n}\n\n@keyframes slide {\n    50% { left: 90%; }\n    100% { left: 5%; }\n}\n\n#fatal-error {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    padding: 1em;\n    color: #fff;\n    background-color: #600;\n}",""])},function(e,t,n){var o=n(13);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(9)(o,r);o.locals&&(e.exports=o.locals)},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,o=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(r=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(e,t,n){(e.exports=n(10)(!1)).push([e.i,".font-bold {\n    font-weight: bold;\n}\n\n.font-italic {\n    font-style: italic;\n}\n\n.font-underline {\n    text-decoration: underline;\n}\n\n.font-proportional {\n    font-family: serif;\n    font-size: 17px;\n}\n\n.font-fixed-width {\n    font-family: monospace;\n    font-size: 15px;\n    padding: 2px 0;\n}\n\n.textcolor-0 {               /* black */\n    color: #000;\n}\n\n.textcolor-1 {               /* blue */\n    color: #00a;\n}\n\n.textcolor-2 {               /* green */\n    color: #0a0;\n}\n\n.textcolor-3 {               /* cyan */\n    color: #0aa;\n}\n\n.textcolor-4 {               /* red */\n    color: #a00;\n}\n\n.textcolor-5 {               /* magenta */\n    color: #a0a;\n}\n\n.textcolor-6 {               /* brown */\n    color: #a50;\n}\n\n.textcolor-7 {               /* white */\n    color: #aaa;\n}\n\n.textcolor-8 {               /* dark gray */\n    color: #555;\n}\n\n.textcolor-9 {               /* light blue */\n    color: #55f;\n}\n\n.textcolor-10 {              /* light green */\n    color: #5f5;\n}\n\n.textcolor-11 {              /* light cyan */\n    color: #5ff;\n}\n\n.textcolor-12 {              /* light red */\n    color: #f55;\n}\n\n.textcolor-13 {              /* light magenta */\n    color: #f5f;\n}\n\n.textcolor-14 {              /* yellow */\n    color: #ff5;\n}\n\n.textcolor-15 {              /* bright white */\n    color: #fff;\n}\n\n\n\n.bgcolor-0 {                 /* black */\n    background-color: #000;\n}\n\n.bgcolor-1 {                 /* blue */\n    background-color: #00a;\n}\n\n.bgcolor-2 {                 /* green */\n    background-color: #0a0;\n}\n\n.bgcolor-3 {                 /* cyan */\n    background-color: #0aa;\n}\n\n.bgcolor-4 {                 /* red */\n    background-color: #a00;\n}\n\n.bgcolor-5 {                 /* magenta */\n    background-color: #a0a;\n}\n\n.bgcolor-6 {                 /* brown */\n    background-color: #a50;\n}\n\n.bgcolor-7 {                 /* white */\n    background-color: #aaa;\n}\n\n.bgcolor-8 {                 /* dark gray */\n    background-color: #555;\n}\n\n.bgcolor-9 {                 /* light blue */\n    background-color: #55f;\n}\n\n.bgcolor-10 {                /* light green */\n    background-color: #5f5;\n}\n\n.bgcolor-11 {                /* light cyan */\n    background-color: #5ff;\n}\n\n.bgcolor-12 {                /* light red */\n    background-color: #f55;\n}\n\n.bgcolor-13 {                /* light magenta */\n    background-color: #f5f;\n}\n\n.bgcolor-14 {                /* yellow */\n    background-color: #ff5;\n}\n\n.bgcolor-15 {                /* bright white */\n    background-color: #fff;\n}\n",""])},function(e,t,n){var o=n(16);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(9)(o,r);o.locals&&(e.exports=o.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=function(){(0,o.addCallback)(function(e){FS.syncfs(!0,function(){if((0,r.get)("extra_opcodes"))FS.writeFile(a,new Uint8Array([66,66]));else try{FS.unlink(a)}catch(e){}try{FS.unlink(i)}catch(e){}FS.syncfs(!1,e)})})},t.process=function(){if(!(0,r.get)("extra_opcodes"))return;var e=FS.readFile(i),t=e.length/2-1,n=[],o=function(e){n.push(e%256),n.push(e>>8)},a=function(t){return e[2*t]+256*e[2*t+1]},s=function(){FS.writeFile(i,new Uint8Array(n))};if(e.length%2==1)return o(20),void s();var l={1:function(){l[a(1)],o(1)},200:function(){o(6)},300:function(){throw window.close(),new Error("Abort opcode called")},500:function(){var t=Module.ccall("hugojs_get_dictionary_word","string",["int"],[e[2]+256*e[3]]);confirm("Game wants to open web address "+t+". Continue?")&&window.open(t)},800:function(){o(0)},900:function(){o(0)},1000:function(){o(1)},1300:function(){o(1)}},c=a(0);if(l[c]){var u={1:1,400:4,500:1,600:1,700:1,1100:4,1600:2}[c]||0;if(t!==u)return o(10),void s();o(0),l[c]()}else{o(30),o(c),o(t);for(var d=1;d<t;++d)o(a(d))}s()};var o=n(7),r=n(0),i="HrCtlAPI",a="HrCheck"},function(e,t,n){"use strict";var o;function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){
/**
   * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
   *
   * @codingstandard ftlabs-jsv2
   * @copyright The Financial Times Limited [All Rights Reserved]
   * @license MIT License (see LICENSE.txt)
   */
function i(e,t){var n;if(t=t||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=t.touchBoundary||10,this.layer=e,this.tapDelay=t.tapDelay||200,this.tapTimeout=t.tapTimeout||700,!i.notNeeded(e)){for(var o=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],r=0,a=o.length;r<a;r++)this[o[r]]=l(this[o[r]],this);s&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,o){var r=Node.prototype.removeEventListener;"click"===t?r.call(e,t,n.hijacked||n,o):r.call(e,t,n,o)},e.addEventListener=function(t,n,o){var r=Node.prototype.addEventListener;"click"===t?r.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),o):r.call(e,t,n,o)}),"function"==typeof e.onclick&&(n=e.onclick,e.addEventListener("click",function(e){n(e)},!1),e.onclick=null)}function l(e,t){return function(){return e.apply(t,arguments)}}}var a=navigator.userAgent.indexOf("Windows Phone")>=0,s=navigator.userAgent.indexOf("Android")>0&&!a,l=/iP(ad|hone|od)/.test(navigator.userAgent)&&!a,c=l&&/OS 4_\d(_\d)?/.test(navigator.userAgent),u=l&&/OS [6-7]_\d/.test(navigator.userAgent),d=navigator.userAgent.indexOf("BB10")>0;i.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(l&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},i.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!s;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},i.prototype.sendClick=function(e,t){var n,o;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),o=t.changedTouches[0],(n=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(e),!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},i.prototype.determineEventType=function(e){return s&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},i.prototype.focus=function(e){var t;l&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},i.prototype.updateScrollParent=function(e){var t,n;if(!(t=e.fastClickScrollParent)||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},i.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},i.prototype.onTouchStart=function(e){var t,n,o;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],l){if((o=window.getSelection()).rangeCount&&!o.isCollapsed)return!0;if(!c){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},i.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n},i.prototype.onTouchMove=function(e){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0)},i.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},i.prototype.onTouchEnd=function(e){var t,n,o,r,i,a=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,u&&(i=e.changedTouches[0],(a=document.elementFromPoint(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset)||a).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(o=a.tagName.toLowerCase())){if(t=this.findControl(a)){if(this.focus(a),s)return!1;a=t}}else if(this.needsFocus(a))return e.timeStamp-n>100||l&&window.top!==window&&"input"===o?(this.targetElement=null,!1):(this.focus(a),this.sendClick(a,e),l&&"select"===o||(this.targetElement=null,e.preventDefault()),!1);return!(!l||c||!(r=a.fastClickScrollParent)||r.fastClickLastScrollTop===r.scrollTop)||(this.needsClick(a)||(e.preventDefault(),this.sendClick(a,e)),!1)},i.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},i.prototype.onMouse=function(e){return!this.targetElement||(!!e.forwardedTouchEvent||(!e.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1))))},i.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail||((t=this.onMouse(e))||(this.targetElement=null),t)},i.prototype.destroy=function(){var e=this.layer;s&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},i.notNeeded=function(e){var t,n,o;if(void 0===window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!s)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(d&&(o=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]>=10&&o[2]>=3&&(t=document.querySelector("meta[name=viewport]"))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(t=document.querySelector("meta[name=viewport]"))&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===e.style.touchAction||"manipulation"===e.style.touchAction))},i.attach=function(e,t){return new i(e,t)},"object"===r(n(11))&&n(11)?void 0===(o=function(){return i}.call(t,n,t,e))||(e.exports=o):void 0!==e&&e.exports?(e.exports=i.attach,e.exports.FastClick=i):window.FastClick=i}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=function(){var e=document.getElementById("loader");e&&e.parentNode.removeChild(e)}},function(e,t){try{var n=new window.CustomEvent("test");if(n.preventDefault(),!0!==n.defaultPrevented)throw new Error("Could not prevent default")}catch(e){var o=function(e,t){var n,o;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o=n.preventDefault,n.preventDefault=function(){o.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},n};o.prototype=window.Event.prototype,window.CustomEvent=o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){(0,l.init)(e.options),(0,i.init)(e.virtualStoryfile),(0,r.addCallback)(function(e){(0,a.init)(),e()}),(0,c.init)({enginePrompt:!!e.enginePrompt,unicode:!!e.unicode}),(0,u.init)({engineColors:!!e.engineColors,engineFontFamily:!!e.engineFontFamily}),(0,r.addCallback)(function(e){(0,s.remove)(),e()}),(0,r.finalCallback)(g),"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){d.default.attach(document.body)},!1)};var o,r=n(7),i=h(n(12)),a=h(n(2)),s=n(20),l=n(0),c=h(n(1)),u=n(4),d=(o=n(19))&&o.__esModule?o:{default:o},f=h(n(6)),p=h(n(5));function h(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}function g(){_haven_start()}window.haven={file:i,input:a,prompt:c,state:f,window:p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clear=function(e){(0,d.clear)(e)},t.filePrompt=function(e){return(0,i.prompt)(e)},t.gameEnded=function(){(0,s.get)("autosave")&&c.autosave.remove();(0,s.get)("exit_url")&&!document.getElementById("fatal-error")&&((0,a.getTextWasPrinted)()?(0,a.setMode)("endgame"):window.location=(0,s.get)("exit_url"))},t.init=function(){var e=function(){(0,r.start)({engineColors:!0,enginePrompt:!0,engineFontFamily:!0,options:hugojs_options,unicode:!1,virtualStoryfile:"game.hex"}),f.init()};if(!hugojs_options.allow_upload||hugojs_options.lock_story||(0,s.getParameter)("story"))e();else{var t=document.createElement("div"),n=document.createElement("h2"),o=document.createElement("input");t.id="uploadContainer",n.textContent="Upload Hugo story file (.hex)",o.type="file",o.addEventListener("change",function(t){(0,s.set)("uploadedFile",this.files[0]),e()}),document.getElementById("loader").style.display="none",t.appendChild(n),t.appendChild(o),document.body.appendChild(t)}},t.initScreen=function(){e=document.getElementById("loader"),e&&e.parentNode.removeChild(e),m();var e},t.print=function(e,t){if("\n"===e)return;(0,o.append)(e,t)},t.restoreUI=function(){return(0,c.restoreUI)()},t.sendWindowDimensions=m,t.setTitle=function(e){return(0,d.setTitle)(e)},t.waitKeypress=function(){return a.keypress.wait()},t.waitKeypressPromise=function(){return a.keypress.waitPromise()},t.waitLine=function(){return(0,l.show)(),(0,l.waitLine)()},t.position=t.font=t.color=t.opcodes=void 0;var o=n(3),r=n(22),i=n(12),a=n(2),s=n(0),l=n(1),c=n(6),u=n(4),d=n(5);var f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(18));t.opcodes=f;var p={set:function(e,t,n){u.color.set(e,t,n)}};t.color=p;var h={set:function(e,t){(0,u.set)("bold",!!(1&e),t),(0,u.set)("italic",!!(2&e),t),(0,u.set)("underline",!!(4&e),t),(0,u.set)("proportional",!!(8&e),t),(0,u.set)("original",e,t)}};t.font=h;var g={set:function(e,t,n){d.position.set(e,t,n)}};function m(){var e=(0,d.measureDimensions)();Module.ccall("hugo_set_window_dimensions","null",["number","number","number","number","number","number"],[e.window.width,e.window.height,e.line.width,e.line.height,e.char.width,e.char.height])}t.position=g,window.Module.arguments=["/game.hex"]},function(e,t,n){"use strict";var o,r=n(7),i=(o=n(8))&&o.__esModule?o:{default:o};window.Module={arguments:[],preRun:[],postRun:[function(){(0,r.finished)("engine")}],print:function(e){(0,i.default)("Unexpected engine output to stdout: "+e)},printErr:function(){console.log(arguments),(0,i.default)(Array.prototype.slice.call(arguments).join(" "))}}},function(e,t,n){"use strict";n(24);var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};o.get||o.set?Object.defineProperty(t,n,o):t[n]=e[n]}return t.default=e,t}(n(23));n(17),n(14),window.hugoui=o}]);